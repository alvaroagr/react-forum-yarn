(this["webpackJsonpreact-forum"]=this["webpackJsonpreact-forum"]||[]).push([[0],{30:function(e,t,a){e.exports=a(45)},35:function(e,t,a){},43:function(e,t,a){},45:function(e,t,a){"use strict";a.r(t);var n=a(0),s=a.n(n),l=a(26),r=a.n(l),c=(a(35),a(1)),i=a(2),o=a(4),m=a(3),u=a(6),h=a(10),d=function(e){Object(o.a)(a,e);var t=Object(m.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(i.a)(a,[{key:"render",value:function(){return s.a.createElement("div",null)}}]),a}(n.Component),p=function(e){Object(o.a)(a,e);var t=Object(m.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(i.a)(a,[{key:"render",value:function(){var e=this.props.msg,t=0;return void 0!==e.children&&(t=e.children.length),s.a.createElement("tr",null,s.a.createElement("td",null,s.a.createElement(u.b,{to:"/messages/".concat(e.id)},e.message)),s.a.createElement("td",null,e.user),s.a.createElement("td",null,t))}}]),a}(n.Component),b=a(20),g=a.n(b);a(40);g.a.initializeApp({apiKey:"AIzaSyCdMMXBjykg-rbamB4ESvO81C2cyEQqhGg",authDomain:"react-forum-73e8a.firebaseapp.com",databaseURL:"https://react-forum-73e8a.firebaseio.com",projectId:"react-forum-73e8a",storageBucket:"react-forum-73e8a.appspot.com",messagingSenderId:"598601410239",appId:"1:598601410239:web:40596151db33aca083880a"});var v=g.a.firestore(),f={getMessage:function(e){return v.collection("messages").doc(e).get()},getChildrenByParent:function(e){return v.collection("messages").where("parent","==",e).get()},getParentByChildren:function(e){return v.collection("messages").where("children","array-contains",e).get()},getMessages:function(){return v.collection("messages").where("parent","==",null).get()},submitMessage:function(e){return v.collection("messages").doc(e.id).set(e,{merge:!0})},deleteMessage:function(e){var t=this;if(void 0!==e.parent){var a={children:[]};this.getMessage(e.parent).then((function(n){(a=n.data()).children.splice(a.children.indexOf(e.id),1),t.submitMessage(a)}))}return v.collection("messages").doc(e.id).delete()},getUsers:function(){return v.collection("users").get()},submitUser:function(e){return v.collection("users").doc(e.id).set(e,{merge:!0})},deleteUser:function(e){return v.collection("users").doc(e.id).delete()}},E=function(e){Object(o.a)(a,e);var t=Object(m.a)(a);function a(){var e;return Object(c.a)(this,a),(e=t.call(this)).state={messages:[]},e}return Object(i.a)(a,[{key:"refresh",value:function(){var e=this,t=[];f.getMessages().then((function(a){a.forEach((function(e){return t.push(e.data())})),e.setState({messages:t})}))}},{key:"componentDidMount",value:function(){var e=this,t=[];f.getMessages().then((function(a){a.forEach((function(e){return t.push(e.data())})),e.setState({messages:t})}))}},{key:"render",value:function(){var e=this.state.messages.map((function(e){return s.a.createElement(p,{key:e.id,msg:e})}));return(s.a.createElement("div",null,s.a.createElement("table",{className:"table table-sm"},s.a.createElement("thead",null,s.a.createElement("tr",null,s.a.createElement("th",null,"Mensaje"),s.a.createElement("th",null,"Autor"),s.a.createElement("th",null,"Respuestas"))),s.a.createElement("tbody",null,e)),s.a.createElement(u.b,{to:"/messages/add"},s.a.createElement("button",{type:"button",className:"btn btn-success"},"Nuevo Mensaje"))))}}]),a}(n.Component),y=a(14),N=function(e){Object(o.a)(a,e);var t=Object(m.a)(a);function a(){var e;return Object(c.a)(this,a),(e=t.call(this)).state={parent:"",children:[],message:"",content:"",user:"",id:""},e}return Object(i.a)(a,[{key:"handleSubmit",value:function(e){e.preventDefault(),console.log(this.state.message);var t={id:""===this.state.id||void 0===this.state.id?Math.floor(255*Math.random()).toString():this.state.id,message:this.state.message,user:this.state.user,content:this.state.content};this.props.onSubmit(t)}},{key:"handleCancel",value:function(e){this.props.onCancel(e)}},{key:"handleChange",value:function(e){this.setState(Object(y.a)({},e.target.id,e.target.value))}},{key:"render",value:function(){return s.a.createElement("div",null,s.a.createElement("form",{onSubmit:this.handleSubmit.bind(this)},s.a.createElement("input",{type:"hidden",className:"form-control",id:"id",value:this.state.id,onChange:this.handleChange.bind(this)}),s.a.createElement("div",{className:"form-group"},s.a.createElement("label",{htmlFor:"user"},"Autor"),s.a.createElement("input",{type:"text",className:"form-control",id:"user",value:this.state.user,onChange:this.handleChange.bind(this)})),s.a.createElement("div",{className:"form-group"},s.a.createElement("label",{htmlFor:"message"},"Mensaje"),s.a.createElement("input",{type:"text",className:"form-control",id:"message",value:this.state.message,onChange:this.handleChange.bind(this)})),s.a.createElement("div",{className:"form-group"},s.a.createElement("label",{htmlFor:"content"},"Contenido"),s.a.createElement("textarea",{className:"form-control",id:"content",value:this.state.content,onChange:this.handleChange.bind(this)})),s.a.createElement("button",{type:"submit",className:"btn btn-primary"},"Submit"),s.a.createElement("button",{className:"btn btn-secondary",onClick:this.handleCancel.bind(this)},"Cancel")))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e.msg.id!==t.id?{parent:e.msg.parent,children:e.msg.children,id:e.msg.id,user:e.msg.user,message:e.msg.message,content:e.msg.content}:null}}]),a}(n.Component),k=function(e){Object(o.a)(a,e);var t=Object(m.a)(a);function a(){var e;return Object(c.a)(this,a),(e=t.call(this)).state={msg:{}},e}return Object(i.a)(a,[{key:"handleSubmit",value:function(e){var t=this;console.log(e),e.parent=null,f.submitMessage(e).then((function(){console.log("saved:",e),t.props.history.push("/messages/".concat(e.id))}))}},{key:"handleCancel",value:function(e){e.preventDefault(),this.props.history.push("/messages"),console.log("You've cancelled the submission.")}},{key:"render",value:function(){return s.a.createElement("div",null,s.a.createElement("h2",null,"Nuevo Mensaje"),s.a.createElement(N,{msg:this.state.msg,onSubmit:this.handleSubmit.bind(this),onCancel:this.handleCancel.bind(this)}))}}]),a}(n.Component),j=function(e){Object(o.a)(a,e);var t=Object(m.a)(a);function a(){var e;return Object(c.a)(this,a),(e=t.call(this)).state={message:{parent:"",id:"",user:"",message:"",content:"",children:[]},parent:{},children:[]},e}return Object(i.a)(a,[{key:"componentDidMount",value:function(){var e=this,t=this.props.match.params;f.getChildrenByParent("".concat(t.id)).then((function(t){return t.forEach((function(t){e.state.children.push(t.data())}))})),f.getParentByChildren("".concat(t.id)).then((function(t){return t.forEach((function(t){e.setState({parent:t.data()})}))})),f.getMessage("".concat(t.id)).then((function(t){t.exists?e.setState({message:t.data()}):console.log("No such document!")}))}},{key:"handleDelete",value:function(){var e=this.props.history;f.deleteMessage(this.state.message).then((function(){console.log("message deleted"),e.push("/messages")}))}},{key:"render",value:function(){var e=this.state.message,t=this.state.children,a=this.state.parent,n="",l=[];n=void 0!==e.parent&&null!==e.parent?s.a.createElement("tr",{key:e.id,className:"table-success text-right"},s.a.createElement("td",null,s.a.createElement("div",{className:"container"},s.a.createElement("b",null,a.user," \u2022 ",s.a.createElement(u.b,{className:"text-dark",to:"/reply/".concat(e.parent)},a.message)),s.a.createElement("p",null,a.content,s.a.createElement("br",null),"Respuestas: ",void 0===a.children?0:a.children.length)))):null,void 0!==e.children&&0!==e.children.length||l.push(s.a.createElement("button",{key:"delete",type:"button",className:"btn btn-danger btn-sm",onClick:this.handleDelete.bind(this)},"Borrar")),l.push(s.a.createElement(u.b,{key:e.id,to:"".concat(e.id,"/edit")},s.a.createElement("button",{type:"button",className:"btn btn-warning btn-sm"},"Editar"))),l.push(s.a.createElement(u.b,{key:"reply",to:"".concat(e.id,"/reply")},s.a.createElement("button",{type:"button",className:"btn btn-success btn-sm"},"Responder")));var r=t.map((function(e){return s.a.createElement("tr",{key:e.id,className:"text-right"},s.a.createElement("td",null,s.a.createElement("div",{className:"container"},s.a.createElement("b",null,e.user," \u2022 ",s.a.createElement(u.b,{className:"text-dark",to:"/reply/".concat(e.id)},e.message)),s.a.createElement("p",null,e.content,s.a.createElement("br",null),"Respuestas: ",void 0===e.children?0:e.children.length))))}));return(s.a.createElement("div",{className:"container"},s.a.createElement("table",{className:"table"},s.a.createElement("tbody",null,n)),s.a.createElement("div",{className:"card border"},s.a.createElement("div",{className:"card-body"},s.a.createElement("h5",{className:"card-title"},e.user," \u2022 ",e.message),s.a.createElement("p",{className:"card-text"},e.content)),s.a.createElement("div",{className:"card-footer text-muted text-right"},l)),s.a.createElement("table",{className:"table table-success"},s.a.createElement("tbody",null,r))))}}]),a}(n.Component),C=function(e){Object(o.a)(a,e);var t=Object(m.a)(a);function a(){var e;return Object(c.a)(this,a),(e=t.call(this)).state={message:{id:""}},e}return Object(i.a)(a,[{key:"componentDidMount",value:function(){var e=this,t=this.props.match.params;f.getMessage("".concat(t.id)).then((function(t){t.exists?(console.log("Document data:",t.data()),e.setState({message:t.data()})):console.log("No such document!")}))}},{key:"handleSubmit",value:function(e){var t=this;f.submitMessage(e).then((function(a){console.log(a),console.log("Message saved."),t.props.history.push("/messages/".concat(e.id))}))}},{key:"handleCancel",value:function(e){e.preventDefault();var t=this.props.history,a=this.state.message;t.push("/messages/".concat(a.id)),console.log("You've cancelled the edit.")}},{key:"render",value:function(){return s.a.createElement("div",null,s.a.createElement("h2",null,"Editar Mensaje"),s.a.createElement(N,{msg:this.state.message,onSubmit:this.handleSubmit.bind(this),onCancel:this.handleCancel.bind(this)}))}}]),a}(n.Component),O=function(e){Object(o.a)(a,e);var t=Object(m.a)(a);function a(){var e;return Object(c.a)(this,a),(e=t.call(this)).state={parentmsg:{id:""},message:{id:""}},e}return Object(i.a)(a,[{key:"componentDidMount",value:function(){var e=this,t=this.props.match.params;f.getMessage("".concat(t.id)).then((function(t){t.exists?(console.log("Document data:",t.data()),e.setState({parentmsg:t.data()})):console.log("No such document!")}))}},{key:"handleSubmit",value:function(e){var t=this,a={parent:this.state.parentmsg.id,id:e.id,message:e.message,content:e.content,user:e.user};f.submitMessage(a).then((function(e){console.log(e),console.log("Reply saved.")}));var n={id:this.state.parentmsg.id,message:this.state.parentmsg.message,content:this.state.parentmsg.content,user:this.state.parentmsg.user,children:this.state.parentmsg.children};void 0===n.children&&(n.children=[]),n.children.push(a.id),f.submitMessage(n).then((function(a){console.log(a),console.log("Parent updated."),t.props.history.push("/messages/".concat(e.id))}))}},{key:"handleCancel",value:function(e){e.preventDefault();var t=this.props.history,a=this.state.parentmsg;t.push("/messages/".concat(a.id)),console.log("You've cancelled the edit.")}},{key:"render",value:function(){return s.a.createElement("div",null,s.a.createElement("h2",null,s.a.createElement("b",null,"Responder a:")," ",this.state.parentmsg.message),s.a.createElement(N,{msg:this.state.message,onSubmit:this.handleSubmit.bind(this),onCancel:this.handleCancel.bind(this)}))}}]),a}(n.Component),S=function(e){Object(o.a)(a,e);var t=Object(m.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(i.a)(a,[{key:"handleDelete",value:function(){var e=this.props.user;this.props.handleDelete(e)}},{key:"render",value:function(){var e=this.props.user;return(s.a.createElement("tr",null,s.a.createElement("td",null,e.id),s.a.createElement("td",null,e.name),s.a.createElement("td",null,e.lastname),s.a.createElement("td",null,e.email),s.a.createElement("td",null,e.password),s.a.createElement("td",null,e.activo),s.a.createElement("td",null,s.a.createElement("button",{className:"btn btn-sm btn-success"},s.a.createElement("div",{className:"fas fa-user"}))),s.a.createElement("td",null,s.a.createElement("button",{className:"btn btn-sm btn-warning"},s.a.createElement("div",{className:"fas fa-pencil-alt"}))),s.a.createElement("td",null,s.a.createElement("button",{className:"btn btn-sm btn-danger",onClick:this.handleDelete.bind(this)},s.a.createElement("div",{className:"fas fa-trash"})))))}}]),a}(n.Component),M=function(e){Object(o.a)(a,e);var t=Object(m.a)(a);function a(){return Object(c.a)(this,a),t.call(this)}return Object(i.a)(a,[{key:"handleDelete",value:function(e){this.props.handleDelete(e)}},{key:"render",value:function(){var e=this,t=this.props.users.map((function(t){return s.a.createElement(S,{key:t.id,user:t,handleDelete:e.handleDelete.bind(e)})}));return s.a.createElement("div",null,s.a.createElement("table",{className:"table table-sm"},s.a.createElement("thead",null,s.a.createElement("tr",null,s.a.createElement("th",null,"ID"),s.a.createElement("th",null,"Nombre"),s.a.createElement("th",null,"Apellido"),s.a.createElement("th",null,"Correo"),s.a.createElement("th",null,"Contrase\xf1a"),s.a.createElement("th",null,"Activo"),s.a.createElement("th",{colSpan:"3"},"Acciones"))),s.a.createElement("tbody",null,t)))}}]),a}(n.Component),D=function(e){Object(o.a)(a,e);var t=Object(m.a)(a);function a(){var e;return Object(c.a)(this,a),(e=t.call(this)).state={users:[]},e}return Object(i.a)(a,[{key:"handleDelete",value:function(e){var t=this;this.props.history;console.log("list:",e),f.deleteUser(e).then((function(){console.log("user deleted"),t.refresh()}))}},{key:"refresh",value:function(){var e=this,t=[];f.getUsers().then((function(a){a.forEach((function(e){return t.push(e.data())})),e.setState({users:t})}))}},{key:"componentDidMount",value:function(){var e=this,t=[];f.getUsers().then((function(a){a.forEach((function(e){return t.push(e.data())})),e.setState({users:t})}))}},{key:"render",value:function(){return s.a.createElement("div",null,s.a.createElement(M,{users:this.state.users,handleDelete:this.handleDelete.bind(this)}))}}]),a}(n.Component),w=a(29),x=a.n(w),A=function(e){Object(o.a)(a,e);var t=Object(m.a)(a);function a(){var e;return Object(c.a)(this,a),(e=t.call(this)).state={id:"",name:"",lastname:"",email:"",password:"",activo:""},e}return Object(i.a)(a,[{key:"handleChange",value:function(e){this.setState(Object(y.a)({},e.target.id,e.target.value))}},{key:"handleSubmit",value:function(e){e.preventDefault();var t={id:""===this.state.id||void 0===this.state.id?Math.floor(255*Math.random()).toString():this.state.id,name:this.state.name,lastname:this.state.lastname,email:this.state.email,password:x.a.hex_md5(this.state.password),activo:this.state.activo};f.submitUser(t),this.props.history.push("/messages")}},{key:"refresh",value:function(){this.setState({id:"",name:"",lastname:"",email:"",password:"",activo:""})}},{key:"render",value:function(){return s.a.createElement("div",{className:"container"},s.a.createElement("form",{onSubmit:this.handleSubmit.bind(this)},s.a.createElement("div",{className:"form-group"},s.a.createElement("label",null,"Nombre     :"),s.a.createElement("input",{type:"text",className:"form-control",placeholder:"nombre",id:"name",value:this.state.name,onChange:this.handleChange.bind(this)})),s.a.createElement("div",{className:"form-group"},s.a.createElement("label",null,"Apellido     :"),s.a.createElement("input",{type:"text",className:"form-control",placeholder:"apellido",id:"lastname",value:this.state.lastname,onChange:this.handleChange.bind(this)})),s.a.createElement("div",{className:"form-group"},s.a.createElement("label",null,"Correo     :"),s.a.createElement("input",{type:"email",className:"form-control",placeholder:"example@exten.com",id:"email",value:this.state.email,onChange:this.handleChange.bind(this)})),s.a.createElement("div",{className:"form-group"},s.a.createElement("label",null,"Password     :"),s.a.createElement("input",{type:"password",className:"form-control",placeholder:"password",id:"password",value:this.state.password,onChange:this.handleChange.bind(this)})),s.a.createElement("div",{className:"form-group"},s.a.createElement("label",null,"Activo     :"),s.a.createElement("select",{className:"form-control form-control",placeholder:"escoge estado",id:"activo",value:this.state.activo,onChange:this.handleChange.bind(this)},s.a.createElement("option",null),s.a.createElement("option",null,"Activo"),s.a.createElement("option",null,"No Activo"))),s.a.createElement("div",{className:"form-group"},s.a.createElement("button",{type:"submit",className:"btn btn-primary"},"Submit"))))}}]),a}(n.Component),B=s.a.createElement(u.a,{basename:"/"},s.a.createElement("nav",{className:"navbar navbar-expand-sm bg-dark navbar-dark"},s.a.createElement("div",{className:"collapse navbar-collapse",id:"navbarTogglerDemo01"},s.a.createElement("ul",{className:"navbar-nav mr-auto my-2 my-lg-0 "},s.a.createElement("li",{className:"nav-item"},s.a.createElement(u.b,{to:"/",className:"nav-link fas fa-home"},"   Home")),s.a.createElement("li",{className:"nav-item"},s.a.createElement(u.b,{to:"/messages",className:"nav-link fas"},"   Mensajes")),s.a.createElement("li",{className:"nav-item"},s.a.createElement(u.b,{to:"/users",className:"nav-link fas"},"   Usuarios"))),s.a.createElement("div",null,s.a.createElement("ul",{className:"navbar-nav mr-auto my-5 my-lg-0"},s.a.createElement("li",{className:"nav-item"},s.a.createElement(u.b,{to:"/register",className:"nav-link fas fa-book"},"    Registrarme")),s.a.createElement("li",{className:"nav-item"},s.a.createElement(u.b,{to:"/login",className:"nav-link fas fa-key"},"    Acceder")))))),s.a.createElement(h.d,null,s.a.createElement(h.b,{path:"/users",component:D}),s.a.createElement(h.b,{path:"/messages/add",component:k}),s.a.createElement(h.b,{path:"/messages/:id/reply",component:O}),s.a.createElement(h.b,{path:"/messages/:id/edit",component:C}),s.a.createElement(h.a,{from:"/reply/:id",to:"/messages/:id"}),s.a.createElement(h.b,{path:"/messages/:id",component:j}),s.a.createElement(h.b,{path:"/messages",component:E}),s.a.createElement(h.b,{exact:!0,path:"/",component:d}),s.a.createElement(h.b,{path:"/register",component:A}))),U=(a(43),function(e){Object(o.a)(a,e);var t=Object(m.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(i.a)(a,[{key:"render",value:function(){return s.a.createElement("div",{className:"container"},B)}}]),a}(n.Component));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(44);r.a.render(s.a.createElement(s.a.StrictMode,null,s.a.createElement(U,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[30,1,2]]]);
//# sourceMappingURL=main.c2c11f23.chunk.js.map